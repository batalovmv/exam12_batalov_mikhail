
# API документация для блога

Этот документ описывает методы API для приложения блога. API позволяет создавать, получать, обновлять и удалять посты и комментарии, а также регистрироваться и входить в систему как пользователь.

## Общая информация

Базовый URL для всех API запросов: `http://localhost:3006`

Все данные, отправляемые и получаемые через API, находятся в формате JSON.

## Эндпоинты

### `/users`

#### POST /users/register

Регистрация нового пользователя.

**Параметры тела запроса:**

- `username`: имя пользователя (строка, обязательное, от 4 до 20 символов)
- `password`: пароль (строка, обязательное, от 8 до 32 символов, минимум одна заглавная буква, одна строчная буква, одно число или спецсимвол)

**Пример ответа:**

```json
{
  "id": 1,
  "username": "newuser",
  "token": "random_token_string"
}
```

#### POST /users/login

Вход в систему существующего пользователя.

**Параметры тела запроса:**

- `username`: имя пользователя (строка, обязательное)
- `password`: пароль (строка, обязательное)

**Пример ответа:**

```json
{
  "token": "random_token_string",
  "username": "user",
  "id": 1
}
```

### `/posts`

#### GET /posts

Получение списка всех постов.

**Пример ответа:**

```json
[
  {
    "id": 1,
    "title": "Post title",
    "description": "Post description",
    "image": "image.jpg",
    "datetime": "2023-10-09T12:00:00.000Z",
    "user": {
      "id": 1,
      "username": "username"
    },
    "commentCount": 5
  },
  ...
]
```

#### GET /posts/:id

Получение поста по его ID.

**Пример ответа:**

```json
{
  "id": 1,
  "title": "Post title",
  "description": "Post description",
  "image": "image.jpg",
  "datetime": "2023-10-09T12:00:00.000Z",
  "user": {
    "id": 1,
    "username": "username"
  },
  "commentCount": 5
}
```

#### POST /posts

Создание нового поста. Требует аутентификации.

**Параметры тела запроса:**

- `title`: заголовок поста (строка, обязательное)
- `description`: описание поста (строка, необязательное)
- `image`: изображение поста (строка, необязательное)

**Пример ответа:**

```json
{
  "id": 1,
  "title": "Post title",
  "description": "Post description",
  "image": "image.jpg",
  "datetime": "2023-10-09T12:00:00.000Z",
  "user": {
    "id": 1,
    "username": "username"
  }
}
```

#### DELETE /posts/:id

Удаление поста по ID. Требует аутентификации и прав пользователя на удаление этого поста.

**Пример ответа:**

```json
{
  "message": "Post successfully deleted"
}
```

### `/comments`

#### GET /comments/:postId

Получение списка комментариев для поста по его ID.

**Пример ответа:**

```json
[
  {
    "id": 1,
    "text": "Comment text",
    "datetime": "2023-10-09T12:00:00.000Z",
    "user": {
      "id": 1,
      "username": "username"
    },
    "post": {
      "id": 1,
      "title": "Post title",
      ...
    }
  },
  ...
]
```

#### POST /comments

Создание нового комментария для поста. Требует аутентификации.

**Параметры тела запроса:**

- `postId`: ID поста (число, обязательное)
- `text`: текст комментария (строка, обязательное)

**Пример ответа:**

```json
{
  "id": 1,
  "postId": 1,
  "text": "Comment text",
  "datetime": "2023-10-09T12:00:00.000Z",
  "user": {
    "id": 1,
    "username": "username"
  }
}
```

#### DELETE /comments/:id

Удаление комментария по ID. Требует аутентификации и прав пользователя на удаление этого комментария.

**Пример ответа:**

```json
{
  "message": "Comment successfully deleted"
}
```

## Коды ответов HTTP

- `200 OK`: Запрос успешно обработан.
- `201 Created`: Успешно создан новый ресурс.
- `204 No Content`: Успешно обработан запрос, не возвращающий никакого содержимого.
- `400 Bad Request`: Сервер не может обработать запрос из-за неверного синтаксиса.
- `401 Unauthorized`: Запрос требует аутентификации пользователя.
- `403 Forbidden`: У клиента нет прав на выполнение операции.
- `404 Not Found`: Запрашиваемый ресурс не найден на сервере.
- `500 Internal Server Error`: Неожиданное состояние сервера, предотвращающее выполнение запроса.

## Аутентификация

Для методов, требующих аутентификации, необходимо передавать заголовок `Authorization` с токеном в формате `Bearer <token>`.
```